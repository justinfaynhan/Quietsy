#include <EEPROM.h>

int sensorVal;
int outputVal;
int ledred = 9;
int ledgreen = 8;
int threshold = 50;
int i = 0;
int average = 0;
int a[5] = {};


void setup()
{
  pinMode(ledred,OUTPUT);
  pinMode(ledgreen,OUTPUT);
  Serial.begin(9600);
}

void loop()
{
  sensorVal = analogRead(A0);
  
  if (i == 5) {
      i = 0; 

      int average = (a[0] + a[1] + a[2] + a[3] + a[4])/5;
      
       
      if (average > threshold) {
          digitalWrite(ledgreen,LOW);
          outputVal = map(sensorVal,0,1023,0,255);
          analogWrite(ledred,outputVal);
      } else {
        digitalWrite(ledred, LOW);
        digitalWrite(ledgreen,HIGH);
      }  

      Serial.print("\'{");
      Serial.print("\"Sensor ID\":");
      
      if (EEPROM[0] = 65) {
          Serial.print("\"");
          Serial.print('A');
      }
      
      Serial.print(EEPROM[1]);
      Serial.print("\"");
 
      Serial.print(", \"Sound Value\"");
      // 0 is 48
      // 1024 is 66
      float value = 56.8888888888888888888888888888; //(1024 - 0)/(66-48) this is the sensitivity range
      sensorVal = sensorVal / value + 48;
      Serial.print(sensorVal);
      Serial.println("}\'");
  }
  
  delay(1000);

  a[i] = sensorVal;
  
  i = i+1;
}
